<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Remove .php extension
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME}\.php -f
    RewriteRule ^(.*)$ $1.php [L]
    
    # ================= PRODUCT URL REWRITES =================
    
    # Handle 3-level product URLs: /products/category/subcategory/product/
    RewriteRule ^products/([^/]+)/([^/]+)/([^/]+)/?$ product-details.php?category_slug=$1&subcategory_slug=$2&product_slug=$3 [L,QSA,B,NE]
    
    # Handle 2-level product URLs: /products/category/product/ (auto-detect subcategory)
    RewriteRule ^products/([^/]+)/([^/]+)/?$ product-details.php?category_slug=$1&product_slug=$2&auto_subcategory=1 [L,QSA,B,NE]
    
    # Subcategory page with slugs
    RewriteRule ^products/([^/]+)/([^/]+)/?$ sub-category.php?category_slug=$1&subcategory_slug=$2 [L,QSA,B,NE]
    
    # Category page with slug
    RewriteRule ^products/([^/]+)/?$ category.php?category_slug=$1 [L,QSA,B,NE]
    
    # Redirect double slash or empty slug to categories page
    RewriteRule ^products//?$ /categories.php [R=301,L]
    
    # ================= ALTERNATIVE ROUTES =================
    
    # Alternative direct routes (if needed)
    RewriteRule ^category/([^/]+)/?$ category.php?category_slug=$1 [L,QSA,B,NE]
    RewriteRule ^sub-category/([^/]+)/?$ sub-category.php?subcategory_slug=$1 [L,QSA,B,NE]
    RewriteRule ^product/([^/]+)/?$ product-details.php?product_slug=$1 [L,QSA,B,NE]
    
    # ================= SPACE HANDLING =================
    
    # Convert spaces to hyphens in URLs (optional - for cleaner URLs)
    RewriteCond %{THE_REQUEST} \s/+(.*?)\s+(.*)\sHTTP
    RewriteRule ^ %1-%2 [L,NE,R=301]
    
    # Convert encoded spaces (%20) to hyphens
    RewriteCond %{THE_REQUEST} /products/([^\s?]*)%20([^\s?]*) [NC]
    RewriteRule ^ /products/%1-%2 [L,R=301,NE]
    
    # Convert multiple spaces/hyphens to single hyphen
    RewriteRule ^(.*?)(-{2,})(.*)$ /$1-$3 [L,R=301]
    RewriteRule ^(.*?)( {2,})(.*)$ /$1-$3 [L,R=301]
</IfModule>

# php -- END cPanel-generated handler, do not edit
